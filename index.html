<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KDP-Ready Book Maker PRO (V4)</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>

<nav class="no-print">
    <div class="logo">KDP-PRO</div>
    <div class="tabs">
        <button id="btn-tab-projects" onclick="showTab('projects')">üìÅ Projects</button>
        <button id="btn-tab-metadata" onclick="showTab('metadata')">1. Info</button>
        <button id="btn-tab-cover" onclick="showTab('cover')">2. Cover</button>
        <button id="btn-tab-chapters" onclick="showTab('chapters')">3. Manuscript</button>
        <button onclick="showTab('export')" class="btn-highlight">4. Export</button>
    </div>
    <div class="stats">Project: <span id="active-project-name">None</span> | <span id="total-words">0</span> words</div>
</nav>

<main class="no-print">
    <section id="tab-projects" class="tab-content">
        <h2>Project Library</h2>
        <div class="project-controls">
            <button onclick="createNewProject()" class="btn-add">Create New Book</button>
            <input type="file" id="import-file" style="display:none" onchange="importProject(this)">
            <button onclick="document.getElementById('import-file').click()">Import .KDP File</button>
        </div>
        <div id="project-list" class="project-grid"></div>
    </section>

    <section id="tab-metadata" class="tab-content" style="display:none">
        <h2>Book Metadata</h2>
        <div class="grid-form">
            <div class="f-group"><label>Title</label><input type="text" id="m-title" oninput="update('metadata','title',this.value)"></div>
            <div class="f-group"><label>Author</label><input type="text" id="m-author" oninput="update('metadata','author',this.value)"></div>
            <div class="f-group"><label>Year</label><input type="text" id="m-year" oninput="update('metadata','copyrightYear',this.value)"></div>
            <div class="f-group"><label>ISBN</label><input type="text" id="m-isbn" oninput="update('metadata','isbn',this.value)"></div>
        </div>
        <h3>Dedication</h3>
        <div id="editor-dedication" class="editor" contenteditable="true" oninput="update('','dedicationHtml',this.innerHTML)"></div>
    </section>

    <section id="tab-cover" class="tab-content" style="display:none">
        <h2>Cover Wrap (6√ó9)</h2>
        <input type="file" accept="image/*" onchange="loadImg(this)">
        <div class="cover-canvas" id="cv-bg">
            <div class="pane back"><textarea oninput="update('cover','backText',this.value)" placeholder="Back blurb..."></textarea></div>
            <div class="pane spine"><div id="sp-txt">TITLE</div></div>
            <div class="pane front"><h1 id="ft-t">TITLE</h1><p id="ft-a">AUTHOR</p></div>
        </div>
    </section>

    <section id="tab-chapters" class="tab-content" style="display:none">
        <div class="ms-layout">
            <div class="side-nav">
                <div id="ch-list"></div>
                <button class="add-btn" onclick="addCh()">+ New Chapter</button>
            </div>
            <div class="editor-body">
                <div class="ch-header">
                    <input type="text" id="ch-title" placeholder="Chapter Title..." oninput="syncCh()">
                    <span id="ch-count">0 words</span>
                </div>
                <div class="toolbar" id="main-toolbar">
                    <button id="btn-bold" title="Bold" onclick="cmd('bold')">B</button>
                    <button id="btn-italic" title="Italic" onclick="cmd('italic')">I</button>
                    <span class="sep">|</span>
                    <button onclick="cmd('formatBlock','H1')">H1</button>
                    <button onclick="cmd('formatBlock','H2')">H2</button>
                    <button onclick="cmd('formatBlock','H3')">H3</button>
                    <button onclick="cmd('formatBlock','p')">Text</button>
                    <span class="sep">|</span>
                    <button onclick="cmd('insertUnorderedList')">‚Ä¢ List</button>
                    <button onclick="cmd('formatBlock','blockquote')">Quote</button>
                </div>
                <div id="main-editor" class="editor" contenteditable="true" oninput="saveCh()"></div>
            </div>
        </div>
    </section>

    <section id="tab-export" class="tab-content" style="display:none">
        <h2>Export & Backup</h2>
        <div class="export-grid">
            <div class="card"><h3>Backup</h3><button onclick="exportProjectFile()">Download .KDP</button></div>
            <div class="card"><h3>Paperback</h3><button onclick="exportPDF()">Export 6x9 PDF</button></div>
            <div class="card"><h3>Kindle</h3><button onclick="exportEPUB()">Export EPUB</button></div>
        </div>
    </section>
</main>
<div id="print-area" class="print-only"></div>
<script src="app.js"></script>
</body>
</html>
